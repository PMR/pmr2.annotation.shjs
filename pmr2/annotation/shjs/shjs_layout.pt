<metal:block use-macro="here/global_defines/macros/defines" />
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master">

<metal:slot metal:fill-slot="css_slot" 
    i18n:domain="pmr2.annotation.shjs">

  <style type="text/css" 
      tal:content="string:@import url($portal_url/++resource++pmr2.annotation.shjs.css/sh_nedit.min.css);">
  </style>

</metal:slot>

<metal:slot metal:fill-slot="javascript_head_slot" 
    i18n:domain="pmr2.annotation.shjs">

  <script type="text/javascript"
      tal:attributes="src string:$portal_url/++resource++pmr2.annotation.shjs.js/sh_main.min.js">
  </script>

  <script type="text/javascript"
      tal:attributes="src string:$portal_url/++resource++pmr2.annotation.shjs.lang/sh_xml.min.js">
  </script>

  <script type="text/javascript"
      tal:attributes="src string:$portal_url/++resource++pmr2.annotation.shjs.lang/sh_html.min.js">
  </script>

  <script type="text/javascript"
      tal:attributes="src string:$portal_url/++resource++pmr2.annotation.shjs.lang/sh_cpp.min.js">
  </script>

  <script type="text/javascript">
  //<![CDATA[
    function resizeMainView() {
        var minHeight = 300;
        var mainView = jq("#shjs-view div")
        var mainViewPre = jq("#shjs-view div pre")
        var winHeight = jq(window).height();
        var viewTop = mainView.offset().top;
        var curHeight = mainViewPre.outerHeight();

        var rawHeight = winHeight - viewTop;
        var maxHeight = Math.max(minHeight, rawHeight);
        var newHeight = Math.min(curHeight, maxHeight);

        mainView.css('height', newHeight);
    };

    var resizeTimer = null;
    jq(window).bind('resize', function() {
        if (resizeTimer) clearTimeout(resizeTimer);
        resizeTimer = setTimeout(resizeMainView, 100);
    });

    jq(document).ready(function() {
      resizeMainView();
      sh_highlightDocument();
    });

  //]]>
  </script>

</metal:slot>

<body>

<metal:slot metal:fill-slot="main" i18n:domain="cmf_default">
  <div id="layout-contents">
    <span tal:replace="structure view/contents" />
  </div>
</metal:slot>
</body>

</html>
